import{f as p}from"./vendor.25d5f69c.js";const b=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const o of e.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(t){if(t.ep)return;t.ep=!0;const e=i(t);fetch(t.href,e)}};b();const h={apiKey:"AIzaSyCLLuCtfkXWrnI_qjSVv-xAuKJtFwo0tCE",authDomain:"instameet-70396.firebaseapp.com",projectId:"instameet-70396",storageBucket:"instameet-70396.appspot.com",messagingSenderId:"562541650861",appId:"1:562541650861:web:ffda472c71156a0567b724"};p.apps.length||p.initializeApp(h);const w=p.firestore(),D={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},n=new RTCPeerConnection(D);let l=null,u=null;const m=document.getElementById("webcamButton"),B=document.getElementById("webcamVideo"),g=document.getElementById("callButton"),y=document.getElementById("callInput"),C=document.getElementById("answerButton"),S=document.getElementById("remoteVideo"),E=document.getElementById("hangupButton");m.onclick=async()=>{l=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),u=new MediaStream,l.getTracks().forEach(a=>{n.addTrack(a,l)}),n.ontrack=a=>{a.streams[0].getTracks().forEach(c=>{u.addTrack(c)})},B.srcObject=l,S.srcObject=u,g.disabled=!1,C.disabled=!1,m.disabled=!0};g.onclick=async()=>{const a=w.collection("calls").doc(),c=a.collection("offerCandidates"),i=a.collection("answerCandidates");y.value=a.id,n.onicecandidate=e=>{e.candidate&&c.add(e.candidate.toJSON())};const s=await n.createOffer();await n.setLocalDescription(s);const t={sdp:s.sdp,type:s.type};await a.set({offer:t}),a.onSnapshot(e=>{const o=e.data();if(!n.currentRemoteDescription&&(o==null?void 0:o.answer)){const d=new RTCSessionDescription(o.answer);n.setRemoteDescription(d)}}),i.onSnapshot(e=>{e.docChanges().forEach(o=>{if(o.type==="added"){const d=new RTCIceCandidate(o.doc.data());n.addIceCandidate(d)}})}),E.disabled=!1};C.onclick=async()=>{const a=y.value,c=w.collection("calls").doc(a),i=c.collection("answerCandidates"),s=c.collection("offerCandidates");n.onicecandidate=r=>{r.candidate&&i.add(r.candidate.toJSON())};const e=(await c.get()).data().offer;await n.setRemoteDescription(new RTCSessionDescription(e));const o=await n.createAnswer();await n.setLocalDescription(o);const d={type:o.type,sdp:o.sdp};await c.update({answer:d}),s.onSnapshot(r=>{r.docChanges().forEach(f=>{if(console.log(f),f.type==="added"){let I=f.doc.data();n.addIceCandidate(new RTCIceCandidate(I))}})})};
