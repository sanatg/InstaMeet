import{f as p}from"./vendor.25d5f69c.js";const b=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const n of e.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function r(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(t){if(t.ep)return;t.ep=!0;const e=r(t);fetch(t.href,e)}};b();const h={apiKey:"AIzaSyCLLuCtfkXWrnI_qjSVv-xAuKJtFwo0tCE",authDomain:"instameet-70396.firebaseapp.com",projectId:"instameet-70396",storageBucket:"instameet-70396.appspot.com",messagingSenderId:"562541650861",appId:"1:562541650861:web:ffda472c71156a0567b724"};p.apps.length||p.initializeApp(h);const w=p.firestore(),D={iceServers:[{urls:["turn:173.194.72.127:19305?transport=udp","turn:[2404:6800:4008:C01::7F]:19305?transport=udp","turn:173.194.72.127:443?transport=tcp","turn:[2404:6800:4008:C01::7F]:443?transport=tcp"],username:"CKjCuLwFEgahxNRjuTAYzc/s6OMT",credential:"u1SQDR/SQsPQIxXNWQT7czc/G4c="},{urls:["stun:stun.l.google.com:19302"]}],iceCandidatePoolSize:10},o=new RTCPeerConnection(D);let l=null,f=null;const m=document.getElementById("webcamButton"),S=document.getElementById("webcamVideo"),g=document.getElementById("callButton"),y=document.getElementById("callInput"),C=document.getElementById("answerButton"),B=document.getElementById("remoteVideo"),E=document.getElementById("hangupButton");m.onclick=async()=>{l=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),f=new MediaStream,l.getTracks().forEach(a=>{o.addTrack(a,l)}),o.ontrack=a=>{a.streams[0].getTracks().forEach(c=>{f.addTrack(c)})},S.srcObject=l,B.srcObject=f,g.disabled=!1,C.disabled=!1,m.disabled=!0};g.onclick=async()=>{const a=w.collection("calls").doc(),c=a.collection("offerCandidates"),r=a.collection("answerCandidates");y.value=a.id,o.onicecandidate=e=>{e.candidate&&c.add(e.candidate.toJSON())};const s=await o.createOffer();await o.setLocalDescription(s);const t={sdp:s.sdp,type:s.type};await a.set({offer:t}),a.onSnapshot(e=>{const n=e.data();if(!o.currentRemoteDescription&&(n==null?void 0:n.answer)){const i=new RTCSessionDescription(n.answer);o.setRemoteDescription(i)}}),r.onSnapshot(e=>{e.docChanges().forEach(n=>{if(n.type==="added"){const i=new RTCIceCandidate(n.doc.data());o.addIceCandidate(i)}})}),E.disabled=!1};C.onclick=async()=>{const a=y.value,c=w.collection("calls").doc(a),r=c.collection("answerCandidates"),s=c.collection("offerCandidates");o.onicecandidate=d=>{d.candidate&&r.add(d.candidate.toJSON())};const e=(await c.get()).data().offer;await o.setRemoteDescription(new RTCSessionDescription(e));const n=await o.createAnswer();await o.setLocalDescription(n);const i={type:n.type,sdp:n.sdp};await c.update({answer:i}),s.onSnapshot(d=>{d.docChanges().forEach(u=>{if(console.log(u),u.type==="added"){let I=u.doc.data();o.addIceCandidate(new RTCIceCandidate(I))}})})};
